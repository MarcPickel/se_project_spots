!function(){"use strict";function e(e,t,r,o){e.textContent=t?o:r}const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},o=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?n(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)};var a;a=t,document.querySelectorAll(a.formSelector).forEach(e=>{((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);o(n,a,t),n.forEach(s=>{s.addEventListener("input",function(){((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,s,t),o(n,a,t)})})})(e,a)});const s=document.querySelector(".profile__avatar-container"),i=s.querySelector(".profile__avatar"),c=s.querySelector(".profile__avatar-button"),l=document.querySelector(".profile__name"),d=document.querySelector(".profile__description"),u=document.querySelector("#avatar-modal"),m=u.querySelector("#profile-avatar-form"),_=m.querySelector("#avatar-image-input"),v=u.querySelector(".modal__submit-button"),h=u.querySelector(".modal__close-button"),f=document.querySelector(".profile__edit-button"),S=document.querySelector("#edit-profile-modal"),y=S.querySelector(".modal__submit-button"),b=S.querySelector(".modal__close-button"),p=S.querySelector("#edit-profile-form"),q=S.querySelector("#profile-name-input"),E=S.querySelector("#profile-description-input"),k=document.querySelector(".profile__add-button"),g=document.querySelector("#new-post-modal"),L=g.querySelector(".modal__submit-button"),C=g.querySelector(".modal__close-button"),$=g.querySelector("#new-post-form"),j=g.querySelector("#card-image-input"),U=g.querySelector("#card-caption-input");let P,x;const w=document.querySelector("#delete-card-modal"),D=w.querySelector(".modal__form"),I=w.querySelector(".modal__close-button"),A=document.querySelector("#preview-modal"),T=A.querySelector(".modal__close-button"),N=A.querySelector(".modal__image"),B=A.querySelector(".modal__caption"),O=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editAvatarImage({avatar:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}getNewCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}changeLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"5ef325c5-f7c1-4719-bb32-13415ad57957","Content-Type":"application/json"}});function J(e){e.classList.add("modal_is-opened"),e.addEventListener("mousedown",z),document.addEventListener("keydown",M)}function H(e){e.classList.remove("modal_is-opened"),e.removeEventListener("mousedown",z),document.removeEventListener("keydown",M)}function z(e){e.target.classList.contains("modal")&&H(e.target)}function M(e){if("Escape"===e.key){const e=document.querySelector(".modal_is-opened");e&&H(e)}}O.getAppInfo().then(([e,t])=>{e.forEach(function(e){const t=K(e);G.append(t)}),i&&(i.src=t.avatar,i.alt=t.name),l.textContent=t.name,d.textContent=t.about}).catch(e=>{console.error(e)}),f.addEventListener("click",function(){q.value=l.textContent,E.value=d.textContent,((e,t,o)=>{t.forEach(t=>{r(e,t,o)})})(p,[q,E],t),J(S)}),c.addEventListener("click",()=>{J(u)}),h.addEventListener("click",()=>{H(u)}),b.addEventListener("click",()=>{H(S)}),k.addEventListener("click",()=>{J(g)}),C.addEventListener("click",()=>{H(g)}),T.addEventListener("click",()=>{H(A)}),I.addEventListener("click",()=>{H(w)}),m.addEventListener("submit",function(r){r.preventDefault();const o=r.submitter;e(o,!0,"Save","Saving..."),O.editAvatarImage({avatar:_.value}).then(e=>{e&&(i.src=e.avatar,n(v,t),H(u),r.target.reset())}).catch(e=>{console.error(e)}).finally(()=>{e(o,!1,"Save","Saving...")})}),p.addEventListener("submit",function(r){r.preventDefault();const o=r.submitter;e(o,!0,"Save","Saving..."),O.editUserInfo({name:q.value,about:E.value}).then(e=>{e&&(l.textContent=e.name,d.textContent=e.about,n(y,t),H(S),r.target.reset())}).catch(e=>{console.error(e)}).finally(()=>{e(o,!1,"Save","Saving...")})}),$.addEventListener("submit",function(r){r.preventDefault();const o=r.submitter;e(o,!0,"Save","Saving..."),O.getNewCard({name:U.value,link:j.value}).then(e=>{if(e){const o=K({name:e.name,link:e.link});G.prepend(o),n(L,t),H(g),r.target.reset()}}).catch(e=>{console.error(e)}).finally(()=>{e(o,!1,"Save","Saving...")})}),D.addEventListener("submit",function(t){t.preventDefault();const r=t.submitter;e(r,!0,"Delete","Deleting..."),O.removeCard(x).then(()=>{P.remove(),H(w)}).catch(e=>{console.error(e)}).finally(()=>{e(r,!1,"Delete","Deleting...")})});const F=document.querySelector("#card-template").content.querySelector(".card"),G=document.querySelector(".cards__list");function K(e){const t=F.cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked?n.classList.add("card__like-button_active"):n.classList.remove("card__like-button_active"),n.addEventListener("click",t=>function(e,t){const r=e.currentTarget,o=r.classList.contains("card__like-button_active");O.changeLike(t,o).then(()=>{r.classList.toggle("card__like-button_active")}).catch(e=>{console.error(e)})}(t,e._id)),a.addEventListener("click",()=>function(e,t){P=e,x=t,J(w)}(t,e._id)),o.addEventListener("click",function(){N.src=e.link,N.alt=e.name,B.textContent=e.name,J(A)}),t}}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQU8sU0FBU0EsRUFBY0MsRUFBUUMsRUFBV0MsRUFBYUMsR0FFMURILEVBQU9JLFlBRExILEVBQ21CRSxFQUVBRCxDQUV6QixDQ3lCQSxNQUFNRyxFQUFXLENBQ2ZDLGFBQWMsZUFDZEMsY0FBZSxnQkFDZkMscUJBQXNCLHdCQUN0QkMsb0JBQXFCLGdDQUNyQkMsZ0JBQWlCLDBCQUNqQkMsV0FBWSxnQkM3QlJDLEVBQWlCQSxDQUFDQyxFQUFhQyxFQUFjQyxLQUNyQkYsRUFBWUcsY0FDdEMsSUFBSUYsRUFBYUcsWUFFQ2IsWUFBYyxHQUNsQ1UsRUFBYUksVUFBVUMsT0FBT0osRUFBT0wsa0JBc0JqQ1UsRUFBb0JBLENBQUNDLEVBQVdDLEVBQWVQLEtBTjVCTSxJQUNoQkEsRUFBVUUsS0FBTVQsSUFDYkEsRUFBYVUsU0FBU0MsT0FLNUJDLENBQWdCTCxHQUNsQk0sRUFBY0wsRUFBZVAsSUFFN0JPLEVBQWNNLFVBQVcsRUFDekJOLEVBQWNKLFVBQVVDLE9BQU9KLEVBQU9OLHVCQUlwQ2tCLEVBQWdCQSxDQUFDTCxFQUFlUCxLQUNwQ08sRUFBY00sVUFBVyxFQUN6Qk4sRUFBY0osVUFBVVcsSUFBSWQsRUFBT04sc0JBeUJYTSxRQ3ZEVFYsRUR3REV5QixTQUFTQyxpQkFBaUJoQixFQUFPVCxjQUN6QzBCLFFBQVNuQixJQWxCTW9CLEVBQUNwQixFQUFhRSxLQUN0QyxNQUFNTSxFQUFZYSxNQUFNQyxLQUN0QnRCLEVBQVlrQixpQkFBaUJoQixFQUFPUixnQkFFaENlLEVBQWdCVCxFQUFZRyxjQUFjRCxFQUFPUCxzQkFFdkRZLEVBQWtCQyxFQUFXQyxFQUFlUCxHQUU1Q00sRUFBVVcsUUFBU2xCLElBQ2pCQSxFQUFhc0IsaUJBQWlCLFFBQVMsV0FoRGhCQyxFQUFDeEIsRUFBYUMsRUFBY0MsS0FDaERELEVBQWFVLFNBQVNDLE1BUXpCYixFQUFlQyxFQUFhQyxFQUFjQyxHQXpCdkJ1QixFQUFDekIsRUFBYUMsRUFBY3lCLEVBQWN4QixLQUNuQ0YsRUFBWUcsY0FDdEMsSUFBSUYsRUFBYUcsWUFFQ2IsWUFBY21DLEVBQ2xDekIsRUFBYUksVUFBVVcsSUFBSWQsRUFBT0wsa0JBYWhDNEIsQ0FDRXpCLEVBQ0FDLEVBQ0FBLEVBQWEwQixrQkFDYnpCLElBMkNBc0IsQ0FBbUJ4QixFQUFhQyxFQUFjQyxHQUM5Q0ssRUFBa0JDLEVBQVdDLEVBQWVQLEVBQzlDLE1BT0FrQixDQUFrQnBCLEVBQWFFLEtDdkRuQyxNQUFNMEIsRUFBb0JYLFNBQVNkLGNBQWMsOEJBQzNDMEIsRUFDSkQsRUFBa0J6QixjQUFjLG9CQUM1QjJCLEVBQXNCRixFQUFrQnpCLGNBQzVDLDJCQUVJNEIsRUFBcUJkLFNBQVNkLGNBQWMsa0JBQzVDNkIsRUFBNEJmLFNBQVNkLGNBQ3pDLHlCQUlJOEIsRUFBcUJoQixTQUFTZCxjQUFjLGlCQUM1QytCLEVBQW9CRCxFQUFtQjlCLGNBQzNDLHdCQUVJZ0MsRUFBeUJELEVBQWtCL0IsY0FDL0MsdUJBRUlpQyxFQUE0QkgsRUFBbUI5QixjQUNuRCx5QkFFSWtDLEVBQTJCSixFQUFtQjlCLGNBQ2xELHdCQUlJbUMsRUFBb0JyQixTQUFTZCxjQUFjLHlCQUMzQ29DLEVBQW1CdEIsU0FBU2QsY0FBYyx1QkFDMUNxQyxFQUEwQkQsRUFBaUJwQyxjQUMvQyx5QkFFSXNDLEVBQXlCRixFQUFpQnBDLGNBQzlDLHdCQUVJdUMsRUFBa0JILEVBQWlCcEMsY0FBYyxzQkFDakR3QyxFQUF1QkosRUFBaUJwQyxjQUM1Qyx1QkFFSXlDLEVBQThCTCxFQUFpQnBDLGNBQ25ELDhCQUlJMEMsRUFBZ0I1QixTQUFTZCxjQUFjLHdCQUN2QzJDLEVBQWU3QixTQUFTZCxjQUFjLG1CQUN0QzRDLEVBQXNCRCxFQUFhM0MsY0FBYyx5QkFDakQ2QyxFQUFxQkYsRUFBYTNDLGNBQWMsd0JBQ2hEOEMsRUFBY0gsRUFBYTNDLGNBQWMsa0JBQ3pDK0MsRUFBbUJKLEVBQWEzQyxjQUFjLHFCQUM5Q2dELEVBQXNCTCxFQUFhM0MsY0FBYyx1QkFHdkQsSUFBSWlELEVBQWNDLEVBR2xCLE1BQU1DLEVBQWNyQyxTQUFTZCxjQUFjLHNCQUNyQ29ELEVBQWFELEVBQVluRCxjQUFjLGdCQUN2Q3FELEVBQXlCRixFQUFZbkQsY0FDekMsd0JBSUlzRCxFQUFleEMsU0FBU2QsY0FBYyxrQkFDdEN1RCxFQUEwQkQsRUFBYXRELGNBQzNDLHdCQUVJd0QsRUFBc0JGLEVBQWF0RCxjQUFjLGlCQUNqRHlELEVBQXdCSCxFQUFhdEQsY0FBYyxtQkFFbkQwRCxFQUFNLElDekZaLE1BQ0VDLFdBQUFBLEVBQVksUUFBRUMsRUFBTyxRQUFFQyxJQUNyQkMsS0FBS0MsU0FBV0gsRUFDaEJFLEtBQUtFLFNBQVdILENBQ2xCLENBRUFJLFVBQUFBLEdBQ0UsT0FBT0MsUUFBUUMsSUFBSSxDQUFDTCxLQUFLTSxrQkFBbUJOLEtBQUtPLGVBQ25ELENBRUFELGVBQUFBLEdBQ0UsT0FBT0UsTUFBTSxHQUFHUixLQUFLQyxpQkFBa0IsQ0FDckNGLFFBQVNDLEtBQUtFLFdBQ2JPLEtBQU1DLEdBQ0hBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRUpSLFFBQVFTLE9BQU8sVUFBVUgsRUFBSUksVUFHMUMsQ0FFQVAsV0FBQUEsR0FDRSxPQUFPQyxNQUFNLEdBQUdSLEtBQUtDLG9CQUFxQixDQUN4Q0YsUUFBU0MsS0FBS0UsV0FDYk8sS0FBTUMsR0FDSEEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFSlIsUUFBUVMsT0FBTyxVQUFVSCxFQUFJSSxVQUcxQyxDQUVBQyxlQUFBQSxFQUFnQixPQUFFQyxJQUNoQixPQUFPUixNQUFNLEdBQUdSLEtBQUtDLDJCQUE0QixDQUMvQ2dCLE9BQVEsUUFDUmxCLFFBQVNDLEtBQUtFLFNBQ2RnQixLQUFNQyxLQUFLQyxVQUFVLENBQ25CSixhQUVEUCxLQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVKUixRQUFRUyxPQUFPLFVBQVVILEVBQUlJLFVBRzFDLENBRUFPLFlBQUFBLEVBQWEsS0FBRUMsRUFBSSxNQUFFQyxJQUNuQixPQUFPZixNQUFNLEdBQUdSLEtBQUtDLG9CQUFxQixDQUN4Q2dCLE9BQVEsUUFDUmxCLFFBQVNDLEtBQUtFLFNBQ2RnQixLQUFNQyxLQUFLQyxVQUFVLENBQ25CRSxPQUNBQyxZQUVEZCxLQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVKUixRQUFRUyxPQUFPLFVBQVVILEVBQUlJLFVBRzFDLENBRUFVLFVBQUFBLEVBQVcsS0FBRUYsRUFBSSxLQUFFRyxJQUNqQixPQUFPakIsTUFBTSxHQUFHUixLQUFLQyxpQkFBa0IsQ0FDckNnQixPQUFRLE9BQ1JsQixRQUFTQyxLQUFLRSxTQUNkZ0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkUsT0FDQUcsV0FFRGhCLEtBQU1DLEdBQ0hBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRUpSLFFBQVFTLE9BQU8sVUFBVUgsRUFBSUksVUFHMUMsQ0FFQVksVUFBQUEsQ0FBV3ZGLEdBQ1QsT0FBT3FFLE1BQU0sR0FBR1IsS0FBS0Msa0JBQWtCOUQsSUFBTSxDQUMzQzhFLE9BQVEsU0FDUmxCLFFBQVNDLEtBQUtFLFdBQ2JPLEtBQU1DLEdBQ0hBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRUpSLFFBQVFTLE9BQU8sVUFBVUgsRUFBSUksVUFHMUMsQ0FFQWEsVUFBQUEsQ0FBV3hGLEVBQUl5RixHQUNiLE9BQU9wQixNQUFNLEdBQUdSLEtBQUtDLGtCQUFrQjlELFVBQVksQ0FDakQ4RSxPQUFRVyxFQUFVLFNBQVcsTUFDN0I3QixRQUFTQyxLQUFLRSxXQUNiTyxLQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVKUixRQUFRUyxPQUFPLFVBQVVILEVBQUlJLFVBRzFDLEdEbkJrQixDQUNsQmhCLFFBQVMsa0RBQ1RDLFFBQVMsQ0FDUDhCLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBc0JwQixTQUFTQyxFQUFVQyxHQUNqQkEsRUFBTTNGLFVBQVVXLElBQUksbUJBQ3BCZ0YsRUFBTXpFLGlCQUFpQixZQUFhMEUsR0FDcENoRixTQUFTTSxpQkFBaUIsVUFBVzJFLEVBQ3ZDLENBRUEsU0FBU0MsRUFBV0gsR0FDbEJBLEVBQU0zRixVQUFVQyxPQUFPLG1CQUN2QjBGLEVBQU1JLG9CQUFvQixZQUFhSCxHQUN2Q2hGLFNBQVNtRixvQkFBb0IsVUFBV0YsRUFDMUMsQ0FnTEEsU0FBU0QsRUFBa0JJLEdBQ3JCQSxFQUFJQyxPQUFPakcsVUFBVWtHLFNBQVMsVUFDaENKLEVBQVdFLEVBQUlDLE9BRW5CLENBR0EsU0FBU0osRUFBa0JHLEdBQ3pCLEdBQWdCLFdBQVpBLEVBQUlHLElBQWtCLENBQ3hCLE1BQU1SLEVBQVEvRSxTQUFTZCxjQUFjLG9CQUNqQzZGLEdBQ0ZHLEVBQVdILEVBRWYsQ0FDRixDQTFOQW5DLEVBQ0dPLGFBQ0FNLEtBQUssRUFBRStCLEVBQU9DLE1BQ2JELEVBQU10RixRQUFRLFNBQVV3RixHQUN0QixNQUFNQyxFQUFjQyxFQUFlRixHQUNuQ0csRUFBVUMsT0FBT0gsRUFDbkIsR0FDSS9FLElBQ0ZBLEVBQXFCbUYsSUFBTU4sRUFBS3pCLE9BQ2hDcEQsRUFBcUJvRixJQUFNUCxFQUFLbkIsTUFFbEN4RCxFQUFtQnhDLFlBQWNtSCxFQUFLbkIsS0FDdEN2RCxFQUEwQnpDLFlBQWNtSCxFQUFLbEIsUUFFOUMwQixNQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixLQXFCbEI3RSxFQUFrQmYsaUJBQWlCLFFBQVMsV0FDMUNvQixFQUFxQjJFLE1BQVF2RixFQUFtQnhDLFlBQ2hEcUQsRUFBNEIwRSxNQUFRdEYsRUFBMEJ6QyxZRHRGeENnSSxFQUFDdkgsRUFBYVEsRUFBV04sS0FDL0NNLEVBQVVXLFFBQVNxRyxJQUNqQnpILEVBQWVDLEVBQWF3SCxFQUFPdEgsTUNxRnJDcUgsQ0FDRTdFLEVBQ0EsQ0FBQ0MsRUFBc0JDLEdBQ3ZCcEQsR0FFRnVHLEVBQVV4RCxFQUNaLEdBRUFULEVBQW9CUCxpQkFBaUIsUUFBUyxLQUM1Q3dFLEVBQVU5RCxLQUdaSSxFQUF5QmQsaUJBQWlCLFFBQVMsS0FDakQ0RSxFQUFXbEUsS0FHYlEsRUFBdUJsQixpQkFBaUIsUUFBUyxLQUMvQzRFLEVBQVc1RCxLQUdiTSxFQUFjdEIsaUJBQWlCLFFBQVMsS0FDdEN3RSxFQUFVakQsS0FHWkUsRUFBbUJ6QixpQkFBaUIsUUFBUyxLQUMzQzRFLEVBQVdyRCxLQUdiWSxFQUF3Qm5DLGlCQUFpQixRQUFTLEtBQ2hENEUsRUFBVzFDLEtBR2JELEVBQXVCakMsaUJBQWlCLFFBQVMsS0FDL0M0RSxFQUFXN0MsS0E2QmJwQixFQUFrQlgsaUJBQWlCLFNBMUJuQyxTQUE0QjhFLEdBQzFCQSxFQUFJb0IsaUJBRUosTUFBTUMsRUFBZXJCLEVBQUlzQixVQUN6QnpJLEVBQWN3SSxHQUFjLEVBQU0sT0FBUSxhQUUxQzdELEVBQ0dtQixnQkFBZ0IsQ0FDZkMsT0FBUTlDLEVBQXVCbUYsUUFFaEM1QyxLQUFNa0QsSUFDREEsSUFDRi9GLEVBQXFCbUYsSUFBTVksRUFBSzNDLE9BRWhDbkUsRUFBY3NCLEVBQTJCNUMsR0FDekMyRyxFQUFXbEUsR0FDWG9FLEVBQUlDLE9BQU91QixXQUdkWCxNQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixLQUVmVyxRQUFRLEtBQ1A1SSxFQUFjd0ksR0FBYyxFQUFPLE9BQVEsY0FFakQsR0FnQ0FoRixFQUFnQm5CLGlCQUFpQixTQTdCakMsU0FBaUM4RSxHQUMvQkEsRUFBSW9CLGlCQUdKLE1BQU1DLEVBQWVyQixFQUFJc0IsVUFDekJ6SSxFQUFjd0ksR0FBYyxFQUFNLE9BQVEsYUFFMUM3RCxFQUNHeUIsYUFBYSxDQUNaQyxLQUFNNUMsRUFBcUIyRSxNQUMzQjlCLE1BQU81QyxFQUE0QjBFLFFBRXBDNUMsS0FBTWtELElBQ0RBLElBQ0Y3RixFQUFtQnhDLFlBQWNxSSxFQUFLckMsS0FDdEN2RCxFQUEwQnpDLFlBQWNxSSxFQUFLcEMsTUFFN0MxRSxFQUFjMEIsRUFBeUJoRCxHQUN2QzJHLEVBQVc1RCxHQUNYOEQsRUFBSUMsT0FBT3VCLFdBR2RYLE1BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEtBRWZXLFFBQVEsS0FDUDVJLEVBQWN3SSxHQUFjLEVBQU8sT0FBUSxjQUVqRCxHQW9DQXpFLEVBQVkxQixpQkFBaUIsU0FqQzdCLFNBQTZCOEUsR0FDM0JBLEVBQUlvQixpQkFFSixNQUFNQyxFQUFlckIsRUFBSXNCLFVBQ3pCekksRUFBY3dJLEdBQWMsRUFBTSxPQUFRLGFBRTFDN0QsRUFDRzRCLFdBQVcsQ0FDVkYsS0FBTXBDLEVBQW9CbUUsTUFDMUI1QixLQUFNeEMsRUFBaUJvRSxRQUV4QjVDLEtBQU1rRCxJQUNMLEdBQUlBLEVBQU0sQ0FDUixNQUtNaEIsRUFBY0MsRUFMQSxDQUNsQnRCLEtBQU1xQyxFQUFLckMsS0FDWEcsS0FBTWtDLEVBQUtsQyxPQUlib0IsRUFBVWlCLFFBQVFuQixHQUVsQjlGLEVBQWNpQyxFQUFxQnZELEdBQ25DMkcsRUFBV3JELEdBQ1h1RCxFQUFJQyxPQUFPdUIsT0FDYixJQUVEWCxNQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixLQUVmVyxRQUFRLEtBQ1A1SSxFQUFjd0ksR0FBYyxFQUFPLE9BQVEsY0FFakQsR0FtQ0FuRSxFQUFXaEMsaUJBQWlCLFNBbkI1QixTQUE0QjhFLEdBQzFCQSxFQUFJb0IsaUJBRUosTUFBTUMsRUFBZXJCLEVBQUlzQixVQUN6QnpJLEVBQWN3SSxHQUFjLEVBQU0sU0FBVSxlQUU1QzdELEVBQ0c4QixXQUFXdEMsR0FDWHFCLEtBQUssS0FDSnRCLEVBQWE5QyxTQUNiNkYsRUFBVzdDLEtBRVo0RCxNQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixLQUVmVyxRQUFRLEtBQ1A1SSxFQUFjd0ksR0FBYyxFQUFPLFNBQVUsZ0JBRW5ELEdBb0JBLE1BQU1NLEVBQWUvRyxTQUNsQmQsY0FBYyxrQkFDZDhILFFBQVE5SCxjQUFjLFNBQ25CMkcsRUFBWTdGLFNBQVNkLGNBQWMsZ0JBRXpDLFNBQVMwRyxFQUFlZSxHQUN0QixNQUFNaEIsRUFBY29CLEVBQWFFLFdBQVUsR0FDckNDLEVBQW1CdkIsRUFBWXpHLGNBQWMsZ0JBQzdDaUksRUFBbUJ4QixFQUFZekcsY0FBYyxnQkFDN0NrSSxFQUF3QnpCLEVBQVl6RyxjQUFjLHNCQUNsRG1JLEVBQTBCMUIsRUFBWXpHLGNBQzFDLHdCQTJCRixPQXhCQWdJLEVBQWlCNUksWUFBY3FJLEVBQUtyQyxLQUNwQzZDLEVBQWlCcEIsSUFBTVksRUFBS2xDLEtBQzVCMEMsRUFBaUJuQixJQUFNVyxFQUFLckMsS0FFeEJxQyxFQUFLL0IsUUFDUHdDLEVBQXNCaEksVUFBVVcsSUFBSSw0QkFFcENxSCxFQUFzQmhJLFVBQVVDLE9BQU8sNEJBR3pDK0gsRUFBc0I5RyxpQkFBaUIsUUFBVThFLEdBM0VuRCxTQUF3QkEsRUFBS2pHLEdBQzNCLE1BQU1qQixFQUFTa0gsRUFBSWtDLGNBQ2IxQyxFQUFVMUcsRUFBT2tCLFVBQVVrRyxTQUFTLDRCQUMxQzFDLEVBQ0crQixXQUFXeEYsRUFBSXlGLEdBQ2ZuQixLQUFLLEtBQ0p2RixFQUFPa0IsVUFBVW1JLE9BQU8sOEJBRXpCdEIsTUFBT0MsSUFDTkMsUUFBUUMsTUFBTUYsSUFFcEIsQ0FpRUlzQixDQUFlcEMsRUFBS3VCLEVBQUtjLE1BRTNCSixFQUF3Qi9HLGlCQUFpQixRQUFTLElBek5wRCxTQUEwQnFGLEVBQWErQixHQUNyQ3ZGLEVBQWV3RCxFQUNmdkQsRUFBaUJzRixFQUNqQjVDLEVBQVV6QyxFQUNaLENBc05Jc0YsQ0FBaUJoQyxFQUFhZ0IsRUFBS2MsTUFHckNOLEVBQWlCN0csaUJBQWlCLFFBQVMsV0FDekNvQyxFQUFvQnFELElBQU1ZLEVBQUtsQyxLQUMvQi9CLEVBQW9Cc0QsSUFBTVcsRUFBS3JDLEtBQy9CM0IsRUFBc0JyRSxZQUFjcUksRUFBS3JDLEtBQ3pDUSxFQUFVdEMsRUFDWixHQUVPbUQsQ0FDVCxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9hcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoYnV0dG9uLCBpc0xvYWRpbmcsIGRlZmF1bHRUZXh0LCBsb2FkaW5nVGV4dCkge1xuICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gZGVmYXVsdFRleHQ7XG4gIH1cbn1cbiIsIi8qY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBicmlkZ2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbCBUaG9yZW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5dOyovXG5cbmNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcbn07XG5cbmV4cG9ydCB7IHNldHRpbmdzIH07XG4iLCJjb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgKTtcbiAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICk7XG4gIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihcbiAgICAgIGZvcm1FbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxuICAgICAgY29uZmlnXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICB9XG59O1xuXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gIH0pO1xufTtcblxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QsIGNvbmZpZykpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cbn07XG5cbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufTtcblxuY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcbiAgfSk7XG59O1xuXG5leHBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCByZXNldFZhbGlkYXRpb24sIGRpc2FibGVCdXR0b24gfTtcbiIsIi8vSW1wb3J0IENTU1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuLy9JbXBvcnQgZnJvbSB1dGlscy5qc1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvYXBpLmpzXCI7XG5pbXBvcnQgeyBzZXRCdXR0b25UZXh0IH0gZnJvbSBcIi4uL3V0aWxzL2hlbHBlcnMuanNcIjtcblxuLy9JbXBvcnRzIGZyb20gY29uc3RhbnRzLmpzXG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLy9JbXBvcnRzIGZyb20gdmFsaWRhdGlvbi5qc1xuaW1wb3J0IHtcbiAgZW5hYmxlVmFsaWRhdGlvbixcbiAgcmVzZXRWYWxpZGF0aW9uLFxuICBkaXNhYmxlQnV0dG9uLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcblxuLy8gUHJvZmlsZSBFbGVtZW50c1xuY29uc3QgcHJvZmlsZUF2YXRhckNvbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1jb250YWluZXJcIik7XG5jb25zdCBwcm9maWxlQXZhdGFyRWxlbWVudCA9XG4gIHByb2ZpbGVBdmF0YXJDb250LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhckJ1dHRvbiA9IHByb2ZpbGVBdmF0YXJDb250LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2F2YXRhci1idXR0b25cIlxuKTtcbmNvbnN0IHByb2ZpbGVOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXG4pO1xuXG4vLyBFZGl0IEF2YXRhciBFbGVtZW50c1xuY29uc3QgcHJvZmlsZUF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XG5jb25zdCBwcm9maWxlQXZhdGFyRm9ybSA9IHByb2ZpbGVBdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWF2YXRhci1mb3JtXCJcbik7XG5jb25zdCBwcm9maWxlQXZhdGFyTGlua0lucHV0ID0gcHJvZmlsZUF2YXRhckZvcm0ucXVlcnlTZWxlY3RvcihcbiAgXCIjYXZhdGFyLWltYWdlLWlucHV0XCJcbik7XG5jb25zdCBwcm9maWxlQXZhdGFyU3VibWl0QnV0dG9uID0gcHJvZmlsZUF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCJcbik7XG5jb25zdCBwcm9maWxlQXZhdGFyQ2xvc2VCdXR0b24gPSBwcm9maWxlQXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuXG4vLyBFZGl0IFByb2ZpbGUgRWxlbWVudHNcbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcbmNvbnN0IGVkaXRQcm9maWxlU3VibWl0QnV0dG9uID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiXG4pO1xuY29uc3QgZWRpdFByb2ZpbGVDbG9zZUJ1dHRvbiA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1mb3JtXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiXG4pO1xuY29uc3QgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5cbi8vIE5ldyBQb3N0IEVsZW1lbnRzXG5jb25zdCBuZXdQb3N0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgbmV3UG9zdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctcG9zdC1tb2RhbFwiKTtcbmNvbnN0IG5ld1Bvc3RTdWJtaXRCdXR0b24gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcbmNvbnN0IG5ld1Bvc3RDbG9zZUJ1dHRvbiA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XG5jb25zdCBuZXdQb3N0Rm9ybSA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI25ldy1wb3N0LWZvcm1cIik7XG5jb25zdCBuZXdQb3N0TGlua0lucHV0ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZS1pbnB1dFwiKTtcbmNvbnN0IG5ld1Bvc3RDYXB0aW9uSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWNhcHRpb24taW5wdXRcIik7XG5cbi8vIENhcmQgUmVsYXRlZCBFbGVtZW50c1xubGV0IHNlbGVjdGVkQ2FyZCwgc2VsZWN0ZWRDYXJkSWQ7XG5cbi8vIERlbGV0ZSBNb2RhbCBFbGVtZW50c1xuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBkZWxldGVNb2RhbENsb3NlQnV0dG9uID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuXG4vLyBQcmV2aWV3IE1vZGFsIEVsZW1lbnRzXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ1dHRvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCJcbik7XG5jb25zdCBwcmV2aWV3SW1hZ2VFbGVtZW50ID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgcHJldmlld0NhcHRpb25FbGVtZW50ID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjVlZjMyNWM1LWY3YzEtNDcxOS1iYjMyLTEzNDE1YWQ1Nzk1N1wiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmFwaVxuICAuZ2V0QXBwSW5mbygpXG4gIC50aGVuKChbY2FyZHMsIHVzZXJdKSA9PiB7XG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xuICAgIH0pO1xuICAgIGlmIChwcm9maWxlQXZhdGFyRWxlbWVudCkge1xuICAgICAgcHJvZmlsZUF2YXRhckVsZW1lbnQuc3JjID0gdXNlci5hdmF0YXI7XG4gICAgICBwcm9maWxlQXZhdGFyRWxlbWVudC5hbHQgPSB1c2VyLm5hbWU7XG4gICAgfVxuICAgIHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gdXNlci5hYm91dDtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gIH0pO1xuXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2lzLW9wZW5lZFwiKTtcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBtb2RhbE92ZXJsYXlDbG9zZSk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZUNsb3NlKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG1vZGFsT3ZlcmxheUNsb3NlKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlQ2xvc2UpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkSWQpIHtcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gIHNlbGVjdGVkQ2FyZElkID0gY2FyZElkO1xuICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xufVxuXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudDtcbiAgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudDtcbiAgcmVzZXRWYWxpZGF0aW9uKFxuICAgIGVkaXRQcm9maWxlRm9ybSxcbiAgICBbZWRpdFByb2ZpbGVOYW1lSW5wdXQsIGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dF0sXG4gICAgc2V0dGluZ3NcbiAgKTtcbiAgb3Blbk1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xufSk7XG5cbnByb2ZpbGVBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKHByb2ZpbGVBdmF0YXJNb2RhbCk7XG59KTtcblxucHJvZmlsZUF2YXRhckNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwocHJvZmlsZUF2YXRhck1vZGFsKTtcbn0pO1xuXG5lZGl0UHJvZmlsZUNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59KTtcblxubmV3UG9zdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcbn0pO1xuXG5uZXdQb3N0Q2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xufSk7XG5cbnByZXZpZXdNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcbn0pO1xuXG5kZWxldGVNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIHRydWUsIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcblxuICBhcGlcbiAgICAuZWRpdEF2YXRhckltYWdlKHtcbiAgICAgIGF2YXRhcjogcHJvZmlsZUF2YXRhckxpbmtJbnB1dC52YWx1ZSxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBpZiAoZGF0YSkge1xuICAgICAgICBwcm9maWxlQXZhdGFyRWxlbWVudC5zcmMgPSBkYXRhLmF2YXRhcjtcblxuICAgICAgICBkaXNhYmxlQnV0dG9uKHByb2ZpbGVBdmF0YXJTdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcbiAgICAgICAgY2xvc2VNb2RhbChwcm9maWxlQXZhdGFyTW9kYWwpO1xuICAgICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XG4gICAgICB9XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIGZhbHNlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG4gICAgfSk7XG59XG5wcm9maWxlQXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICAvLyBDaGFuZ2UgdGV4dCBjb250ZW50IHRvIFwiU2F2aW5nLi4uXCIgb3IgXCJEZWxldGluZy4uLlwiXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLmVkaXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSxcbiAgICAgIGFib3V0OiBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUsXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgcHJvZmlsZU5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgICAgICBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcblxuICAgICAgICBkaXNhYmxlQnV0dG9uKGVkaXRQcm9maWxlU3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XG4gICAgICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG4gICAgICAgIGV2dC50YXJnZXQucmVzZXQoKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UsIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcbiAgICB9KTtcbn1cbmVkaXRQcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KTtcblxuZnVuY3Rpb24gaGFuZGxlTmV3UG9zdFN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIHRydWUsIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcblxuICBhcGlcbiAgICAuZ2V0TmV3Q2FyZCh7XG4gICAgICBuYW1lOiBuZXdQb3N0Q2FwdGlvbklucHV0LnZhbHVlLFxuICAgICAgbGluazogbmV3UG9zdExpbmtJbnB1dC52YWx1ZSxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBpZiAoZGF0YSkge1xuICAgICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHtcbiAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgICAgbGluazogZGF0YS5saW5rLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaW5wdXRWYWx1ZXMpO1xuICAgICAgICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XG5cbiAgICAgICAgZGlzYWJsZUJ1dHRvbihuZXdQb3N0U3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XG4gICAgICAgIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbiAgICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgICAgfVxuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCBmYWxzZSwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xuICAgIH0pO1xufVxubmV3UG9zdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVOZXdQb3N0U3VibWl0KTtcblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNhcmQoZXZ0LCBpZCkge1xuICBjb25zdCBidXR0b24gPSBldnQuY3VycmVudFRhcmdldDtcbiAgY29uc3QgaXNMaWtlZCA9IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIGFwaVxuICAgIC5jaGFuZ2VMaWtlKGlkLCBpc0xpa2VkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBzdWJtaXRCdXR0b24gPSBldnQuc3VibWl0dGVyO1xuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgdHJ1ZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcblxuICBhcGlcbiAgICAucmVtb3ZlQ2FyZChzZWxlY3RlZENhcmRJZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XG4gICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XG4gICAgfSk7XG59XG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcblxuLy8gbW9kYWxPdmVybGF5Q2xvc2UgZmVhdHVyZVxuZnVuY3Rpb24gbW9kYWxPdmVybGF5Q2xvc2UoZXZ0KSB7XG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcbiAgfVxufVxuXG4vLyBoYW5kbGVFc2NhcGVDbG9zZSBmZWF0dXJlXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGVDbG9zZShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfaXMtb3BlbmVkXCIpO1xuICAgIGlmIChtb2RhbCkge1xuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XG4gICAgfVxuICB9XG59XG5cbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gIC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIilcbiAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gIGNvbnN0IGNhcmRUaXRsZUVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICBjb25zdCBjYXJkSW1hZ2VFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZExpa2VCdXR0b25FbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbkVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICApO1xuXG4gIGNhcmRUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIGNhcmRJbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xuICBjYXJkSW1hZ2VFbGVtZW50LmFsdCA9IGRhdGEubmFtZTtcblxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XG4gICAgY2FyZExpa2VCdXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH0gZWxzZSB7XG4gICAgY2FyZExpa2VCdXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH1cblxuICBjYXJkTGlrZUJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XG4gICAgaGFuZGxlTGlrZUNhcmQoZXZ0LCBkYXRhLl9pZClcbiAgKTtcbiAgY2FyZERlbGV0ZUJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YS5faWQpXG4gICk7XG5cbiAgY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgIHByZXZpZXdJbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdJbWFnZUVsZW1lbnQuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdDYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEFwcEluZm8oKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZWRpdEF2YXRhckltYWdlKHsgYXZhdGFyIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGdldE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGNoYW5nZUxpa2UoaWQsIGlzTGlrZWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiJdLCJuYW1lcyI6WyJzZXRCdXR0b25UZXh0IiwiYnV0dG9uIiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJsb2FkaW5nVGV4dCIsInRleHRDb250ZW50Iiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJjb25maWciLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwicHJvZmlsZUF2YXRhckNvbnQiLCJwcm9maWxlQXZhdGFyRWxlbWVudCIsInByb2ZpbGVBdmF0YXJCdXR0b24iLCJwcm9maWxlTmFtZUVsZW1lbnQiLCJwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50IiwicHJvZmlsZUF2YXRhck1vZGFsIiwicHJvZmlsZUF2YXRhckZvcm0iLCJwcm9maWxlQXZhdGFyTGlua0lucHV0IiwicHJvZmlsZUF2YXRhclN1Ym1pdEJ1dHRvbiIsInByb2ZpbGVBdmF0YXJDbG9zZUJ1dHRvbiIsImVkaXRQcm9maWxlQnV0dG9uIiwiZWRpdFByb2ZpbGVNb2RhbCIsImVkaXRQcm9maWxlU3VibWl0QnV0dG9uIiwiZWRpdFByb2ZpbGVDbG9zZUJ1dHRvbiIsImVkaXRQcm9maWxlRm9ybSIsImVkaXRQcm9maWxlTmFtZUlucHV0IiwiZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwibmV3UG9zdEJ1dHRvbiIsIm5ld1Bvc3RNb2RhbCIsIm5ld1Bvc3RTdWJtaXRCdXR0b24iLCJuZXdQb3N0Q2xvc2VCdXR0b24iLCJuZXdQb3N0Rm9ybSIsIm5ld1Bvc3RMaW5rSW5wdXQiLCJuZXdQb3N0Q2FwdGlvbklucHV0Iiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJkZWxldGVNb2RhbENsb3NlQnV0dG9uIiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsQ2xvc2VCdXR0b24iLCJwcmV2aWV3SW1hZ2VFbGVtZW50IiwicHJldmlld0NhcHRpb25FbGVtZW50IiwiYXBpIiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImVkaXRBdmF0YXJJbWFnZSIsImF2YXRhciIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdFVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwiZ2V0TmV3Q2FyZCIsImxpbmsiLCJyZW1vdmVDYXJkIiwiY2hhbmdlTGlrZSIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwib3Blbk1vZGFsIiwibW9kYWwiLCJtb2RhbE92ZXJsYXlDbG9zZSIsImhhbmRsZUVzY2FwZUNsb3NlIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJ0YXJnZXQiLCJjb250YWlucyIsImtleSIsImNhcmRzIiwidXNlciIsIml0ZW0iLCJjYXJkRWxlbWVudCIsImdldENhcmRFbGVtZW50IiwiY2FyZHNMaXN0IiwiYXBwZW5kIiwic3JjIiwiYWx0IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJ2YWx1ZSIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0IiwicHJldmVudERlZmF1bHQiLCJzdWJtaXRCdXR0b24iLCJzdWJtaXR0ZXIiLCJkYXRhIiwicmVzZXQiLCJmaW5hbGx5IiwicHJlcGVuZCIsImNhcmRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkVGl0bGVFbGVtZW50IiwiY2FyZEltYWdlRWxlbWVudCIsImNhcmRMaWtlQnV0dG9uRWxlbWVudCIsImNhcmREZWxldGVCdXR0b25FbGVtZW50IiwiY3VycmVudFRhcmdldCIsInRvZ2dsZSIsImhhbmRsZUxpa2VDYXJkIiwiX2lkIiwiY2FyZElkIiwiaGFuZGxlRGVsZXRlQ2FyZCJdLCJzb3VyY2VSb290IjoiIn0=